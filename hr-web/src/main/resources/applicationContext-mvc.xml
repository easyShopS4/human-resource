<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
       ">

    <!-- mvc 注解驱动.. -->
    <mvc:annotation-driven conversion-service="conversionServiceFactoryBean" />

    <!-- 静态资源过滤 -->
    <mvc:default-servlet-handler/>

    <!-- 接口跨域配置 -->
    <mvc:cors>
        <!-- allowed-methods="*" --> <!-- 表示所有请求都有效 -->
        <mvc:mapping path="/**" allowed-origins="*"
                     allowed-methods="POST, GET, OPTIONS, DELETE, PUT"
                     allowed-headers="Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With"
                     allow-credentials="true" />
    </mvc:cors>

    <!-- 日期转换器配置~ 支持 yyyy/MM/dd yyyy-MM-dd 以及时分秒~ -->
    <!--日期转换器-->
    <bean id="conversionServiceFactoryBean"
          class="org.springframework.context.support.ConversionServiceFactoryBean">
        <property name="converters">
            <list>
                <bean class="com.hr.api.config.DateInterceptor"></bean>
            </list>
        </property>
    </bean>

    <!-- 拦截器 -->
    <mvc:interceptors>
        <!-- 用户是否登录 作用的拦截器 -->
        <mvc:interceptor>
            <mvc:mapping path="/**"/>

            <!-- 不拦截 login方法-->
            <mvc:exclude-mapping path="/ssm/users/login"/>

            <bean class="com.hr.ssm.interceptor.AllInterceptor"></bean>
        </mvc:interceptor>

        <!-- 经过权限验证后，拦截所有controller，用来获取用户的token信息 -->
        <mvc:interceptor>
            <mvc:mapping path="/**"/>
            <mvc:exclude-mapping path="/ssm/users/login"/>
            <bean class="com.hr.ssm.interceptor.UserTokenInterceptor"></bean>
        </mvc:interceptor>
    </mvc:interceptors>


</beans>